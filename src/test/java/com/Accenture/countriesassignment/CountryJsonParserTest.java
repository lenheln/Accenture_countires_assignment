package com.Accenture.countriesassignment;

import com.Accenture.countriesassignment.domain.BaseCountry;
import com.Accenture.countriesassignment.domain.CountryName;
import com.Accenture.countriesassignment.domain.NativeName;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;

import java.util.HashMap;
import java.util.List;

@SpringBootTest
public class CountryJsonParserTest {

    @Autowired
    private CountryJsonParserImpl parser;
    private final String json = "[\r\n    {\r\n        \"name\": {\r\n            \"common\": \"Austria\",\r\n            \"official\": \"Republic of Austria\",\r\n            \"nativeName\": {\r\n                \"bar\": {\r\n                    \"official\": \"Republik √ñsterreich\",\r\n                    \"common\": \"√ñsterreich\"\r\n                }\r\n            }\r\n        },\r\n        \"tld\": [\r\n            \".at\"\r\n        ],\r\n        \"cca2\": \"AT\",\r\n        \"ccn3\": \"040\",\r\n        \"cca3\": \"AUT\",\r\n        \"cioc\": \"AUT\",\r\n        \"independent\": true,\r\n        \"status\": \"officially-assigned\",\r\n        \"unMember\": true,\r\n        \"currencies\": {\r\n            \"EUR\": {\r\n                \"name\": \"Euro\",\r\n                \"symbol\": \"‚Ç¨\"\r\n            }\r\n        },\r\n        \"idd\": {\r\n            \"root\": \"+4\",\r\n            \"suffixes\": [\r\n                \"3\"\r\n            ]\r\n        },\r\n        \"capital\": [\r\n            \"Vienna\"\r\n        ],\r\n        \"altSpellings\": [\r\n            \"AT\",\r\n            \"Osterreich\",\r\n            \"Oesterreich\"\r\n        ],\r\n        \"region\": \"Europe\",\r\n        \"subregion\": \"Central Europe\",\r\n        \"languages\": {\r\n            \"de\": \"German\"\r\n        },\r\n        \"translations\": {\r\n            \"ara\": {\r\n                \"official\": \"ÿ¨ŸÖŸáŸàÿ±Ÿäÿ© ÿßŸÑŸÜŸÖÿ≥ÿß\",\r\n                \"common\": \"ÿßŸÑŸÜŸÖÿ≥ÿß\"\r\n            },\r\n            \"bre\": {\r\n                \"official\": \"Republik Aostria\",\r\n                \"common\": \"Aostria\"\r\n            },\r\n            \"ces\": {\r\n                \"official\": \"Rakousk√° republika\",\r\n                \"common\": \"Rakousko\"\r\n            },\r\n            \"cym\": {\r\n                \"official\": \"Gweriniaeth Awstria\",\r\n                \"common\": \"Awstria\"\r\n            },\r\n            \"deu\": {\r\n                \"official\": \"Republik √ñsterreich\",\r\n                \"common\": \"√ñsterreich\"\r\n            },\r\n            \"est\": {\r\n                \"official\": \"Austria Vabariik\",\r\n                \"common\": \"Austria\"\r\n            },\r\n            \"fin\": {\r\n                \"official\": \"It√§vallan tasavalta\",\r\n                \"common\": \"It√§valta\"\r\n            },\r\n            \"fra\": {\r\n                \"official\": \"R√©publique d'Autriche\",\r\n                \"common\": \"Autriche\"\r\n            },\r\n            \"hrv\": {\r\n                \"official\": \"Republika Austrija\",\r\n                \"common\": \"Austrija\"\r\n            },\r\n            \"hun\": {\r\n                \"official\": \"Ausztria\",\r\n                \"common\": \"Ausztria\"\r\n            },\r\n            \"ita\": {\r\n                \"official\": \"Repubblica d'Austria\",\r\n                \"common\": \"Austria\"\r\n            },\r\n            \"jpn\": {\r\n                \"official\": \"„Ç™„Éº„Çπ„Éà„É™„Ç¢ÂÖ±ÂíåÂõΩ\",\r\n                \"common\": \"„Ç™„Éº„Çπ„Éà„É™„Ç¢\"\r\n            },\r\n            \"kor\": {\r\n                \"official\": \"Ïò§Ïä§Ìä∏Î¶¨ÏïÑ Í≥µÌôîÍµ≠\",\r\n                \"common\": \"Ïò§Ïä§Ìä∏Î¶¨ÏïÑ\"\r\n            },\r\n            \"nld\": {\r\n                \"official\": \"Republiek Oostenrijk\",\r\n                \"common\": \"Oostenrijk\"\r\n            },\r\n            \"per\": {\r\n                \"official\": \"ÿ¨ŸÖŸáŸàÿ±€å ÿßÿ™ÿ±€åÿ¥\",\r\n                \"common\": \"ÿßÿ™ÿ±€åÿ¥\"\r\n            },\r\n            \"pol\": {\r\n                \"official\": \"Republika Austrii\",\r\n                \"common\": \"Austria\"\r\n            },\r\n            \"por\": {\r\n                \"official\": \"Rep√∫blica da √Åustria\",\r\n                \"common\": \"√Åustria\"\r\n            },\r\n            \"rus\": {\r\n                \"official\": \"–ê–≤—Å—Ç—Ä–∏–π—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞\",\r\n                \"common\": \"–ê–≤—Å—Ç—Ä–∏—è\"\r\n            },\r\n            \"slk\": {\r\n                \"official\": \"Rak√∫ska republika\",\r\n                \"common\": \"Rak√∫sko\"\r\n            },\r\n            \"spa\": {\r\n                \"official\": \"Rep√∫blica de Austria\",\r\n                \"common\": \"Austria\"\r\n            },\r\n            \"srp\": {\r\n                \"official\": \"–†–µ–ø—É–±–ª–∏–∫–∞ –ê—É—Å—Ç—Ä–∏—ò–∞\",\r\n                \"common\": \"–ê—É—Å—Ç—Ä–∏—ò–∞\"\r\n            },\r\n            \"swe\": {\r\n                \"official\": \"Republiken √ñsterrike\",\r\n                \"common\": \"√ñsterrike\"\r\n            },\r\n            \"tur\": {\r\n                \"official\": \"Avusturya Cumhuriyeti\",\r\n                \"common\": \"Avusturya\"\r\n            },\r\n            \"urd\": {\r\n                \"official\": \"ÿ¨ŸÖ€ÅŸàÿ±€å€Å ÿ¢ÿ≥Ÿπÿ±€åÿß\",\r\n                \"common\": \"ÿ¢ÿ≥Ÿπÿ±€åÿß\"\r\n            },\r\n            \"zho\": {\r\n                \"official\": \"Â••Âú∞Âà©ÂÖ±ÂíåÂõΩ\",\r\n                \"common\": \"Â••Âú∞Âà©\"\r\n            }\r\n        },\r\n        \"latlng\": [\r\n            47.33333333,\r\n            13.33333333\r\n        ],\r\n        \"landlocked\": true,\r\n        \"borders\": [\r\n            \"CZE\",\r\n            \"DEU\",\r\n            \"HUN\",\r\n            \"ITA\",\r\n            \"LIE\",\r\n            \"SVK\",\r\n            \"SVN\",\r\n            \"CHE\"\r\n        ],\r\n        \"area\": 83871.0,\r\n        \"demonyms\": {\r\n            \"eng\": {\r\n                \"f\": \"Austrian\",\r\n                \"m\": \"Austrian\"\r\n            },\r\n            \"fra\": {\r\n                \"f\": \"Autrichienne\",\r\n                \"m\": \"Autrichien\"\r\n            }\r\n        },\r\n        \"flag\": \"üá¶üáπ\",\r\n        \"maps\": {\r\n            \"googleMaps\": \"https://goo.gl/maps/pCWpWQhznHyRzQcu9\",\r\n            \"openStreetMaps\": \"https://www.openstreetmap.org/relation/16239\"\r\n        },\r\n        \"population\": 8917205,\r\n        \"gini\": {\r\n            \"2018\": 30.8\r\n        },\r\n        \"fifa\": \"AUT\",\r\n        \"car\": {\r\n            \"signs\": [\r\n                \"A\"\r\n            ],\r\n            \"side\": \"right\"\r\n        },\r\n        \"timezones\": [\r\n            \"UTC+01:00\"\r\n        ],\r\n        \"continents\": [\r\n            \"Europe\"\r\n        ],\r\n        \"flags\": {\r\n            \"png\": \"https://flagcdn.com/w320/at.png\",\r\n            \"svg\": \"https://flagcdn.com/at.svg\",\r\n            \"alt\": \"The flag of Austria is composed of three equal horizontal bands of red, white and red.\"\r\n        },\r\n        \"coatOfArms\": {\r\n            \"png\": \"https://mainfacts.com/media/images/coats_of_arms/at.png\",\r\n            \"svg\": \"https://mainfacts.com/media/images/coats_of_arms/at.svg\"\r\n        },\r\n        \"startOfWeek\": \"monday\",\r\n        \"capitalInfo\": {\r\n            \"latlng\": [\r\n                48.2,\r\n                16.37\r\n            ]\r\n        },\r\n        \"postalCode\": {\r\n            \"format\": \"####\",\r\n            \"regex\": \"^(\\\\d{4})$\"\r\n        }\r\n    }\r\n]\r\n";

    @Test
    public void parse_json_correct() {

        NativeName nativeName = new NativeName("√ñsterreich","Republik √ñsterreich");
        HashMap<String, NativeName> nativeNameMap = new HashMap<>();
        nativeNameMap.put("bar", nativeName);

        CountryName countryName = new CountryName(nativeNameMap, "Republic of Austria", "Austria");
        BaseCountry country = new BaseCountry();
        country.setName(countryName);
        country.setArea(83871.0);
        country.setPopulation(8917205);

        List<BaseCountry> countries = parser.parse(json);
        Assertions.assertTrue(countries.contains(country));
        Assertions.assertEquals(1, countries.size());
    }
}
